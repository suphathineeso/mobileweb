const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/web-BJu7l8wI.js","assets/index-C7q3mDg_.js","assets/index-CV2ytict.css","assets/_plugin-vue_export-helper-DlAUqK2U.js","assets/web-DhEbpNFh.js","assets/web-CXbxi2Mx.js"])))=>i.map(i=>d[i]);
var ne=Object.defineProperty;var re=(s,e,t)=>e in s?ne(s,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):s[e]=t;var T=(s,e,t)=>re(s,typeof e!="symbol"?e+"":e,t);import{_ as j,d as ie,r as J,o as oe,a as le,c as ce,b as de,w as E,u as y,I as ue,e as M,f as pe,g as he,h as A,i as fe,j as f,t as O,k as G,l as ve,m as ge,n as we,p as me,q as be,s as ye}from"./index-C7q3mDg_.js";import{_ as ke}from"./_plugin-vue_export-helper-DlAUqK2U.js";/*! Capacitor: https://capacitorjs.com/ - MIT License */var R;(function(s){s.Unimplemented="UNIMPLEMENTED",s.Unavailable="UNAVAILABLE"})(R||(R={}));class q extends Error{constructor(e,t,r){super(e),this.message=e,this.code=t,this.data=r}}const Pe=s=>{var e,t;return s!=null&&s.androidBridge?"android":!((t=(e=s==null?void 0:s.webkit)===null||e===void 0?void 0:e.messageHandlers)===null||t===void 0)&&t.bridge?"ios":"web"},Te=s=>{const e=s.CapacitorCustomPlatform||null,t=s.Capacitor||{},r=t.Plugins=t.Plugins||{},n=()=>e!==null?e.name:Pe(s),a=()=>n()!=="web",i=p=>{const c=g.get(p);return!!(c!=null&&c.platforms.has(n())||l(p))},l=p=>{var c;return(c=t.PluginHeaders)===null||c===void 0?void 0:c.find(b=>b.name===p)},u=p=>s.console.error(p),g=new Map,_=(p,c={})=>{const b=g.get(p);if(b)return console.warn('Capacitor plugin "'.concat(p,'" already registered. Cannot register plugins twice.')),b.proxy;const L=n(),d=l(p);let o;const B=async()=>(!o&&L in c?o=typeof c[L]=="function"?o=await c[L]():o=c[L]:e!==null&&!o&&"web"in c&&(o=typeof c.web=="function"?o=await c.web():o=c.web),o),F=(h,v)=>{var m,k;if(d){const P=d==null?void 0:d.methods.find(w=>v===w.name);if(P)return P.rtype==="promise"?w=>t.nativePromise(p,v.toString(),w):(w,S)=>t.nativeCallback(p,v.toString(),w,S);if(h)return(m=h[v])===null||m===void 0?void 0:m.bind(h)}else{if(h)return(k=h[v])===null||k===void 0?void 0:k.bind(h);throw new q('"'.concat(p,'" plugin is not implemented on ').concat(L),R.Unimplemented)}},C=h=>{let v;const m=(...k)=>{const P=B().then(w=>{const S=F(w,h);if(S){const I=S(...k);return v=I==null?void 0:I.remove,I}else throw new q('"'.concat(p,".").concat(h,'()" is not implemented on ').concat(L),R.Unimplemented)});return h==="addListener"&&(P.remove=async()=>v()),P};return m.toString=()=>"".concat(h.toString(),"() { [capacitor code] }"),Object.defineProperty(m,"name",{value:h,writable:!1,configurable:!1}),m},$=C("addListener"),H=C("removeListener"),N=(h,v)=>{const m=$({eventName:h},v),k=async()=>{const w=await m;H({eventName:h,callbackId:w},v)},P=new Promise(w=>m.then(()=>w({remove:k})));return P.remove=async()=>{console.warn("Using addListener() without 'await' is deprecated."),await k()},P},x=new Proxy({},{get(h,v){switch(v){case"$$typeof":return;case"toJSON":return()=>({});case"addListener":return d?N:$;case"removeListener":return H;default:return C(v)}}});return r[p]=x,g.set(p,{name:p,proxy:x,platforms:new Set([...Object.keys(c),...d?[L]:[]])}),x};return t.convertFileSrc||(t.convertFileSrc=p=>p),t.getPlatform=n,t.handleError=u,t.isNativePlatform=a,t.isPluginAvailable=i,t.registerPlugin=_,t.Exception=q,t.DEBUG=!!t.DEBUG,t.isLoggingEnabled=!!t.isLoggingEnabled,t},Ee=s=>s.Capacitor=Te(s),U=Ee(typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{}),W=U.registerPlugin;class z{constructor(){this.listeners={},this.retainedEventArguments={},this.windowListeners={}}addListener(e,t){let r=!1;this.listeners[e]||(this.listeners[e]=[],r=!0),this.listeners[e].push(t);const a=this.windowListeners[e];a&&!a.registered&&this.addWindowListener(a),r&&this.sendRetainedArgumentsForEvent(e);const i=async()=>this.removeListener(e,t);return Promise.resolve({remove:i})}async removeAllListeners(){this.listeners={};for(const e in this.windowListeners)this.removeWindowListener(this.windowListeners[e]);this.windowListeners={}}notifyListeners(e,t,r){const n=this.listeners[e];if(!n){if(r){let a=this.retainedEventArguments[e];a||(a=[]),a.push(t),this.retainedEventArguments[e]=a}return}n.forEach(a=>a(t))}hasListeners(e){var t;return!!(!((t=this.listeners[e])===null||t===void 0)&&t.length)}registerWindowListener(e,t){this.windowListeners[t]={registered:!1,windowEventName:e,pluginEventName:t,handler:r=>{this.notifyListeners(t,r)}}}unimplemented(e="not implemented"){return new U.Exception(e,R.Unimplemented)}unavailable(e="not available"){return new U.Exception(e,R.Unavailable)}async removeListener(e,t){const r=this.listeners[e];if(!r)return;const n=r.indexOf(t);this.listeners[e].splice(n,1),this.listeners[e].length||this.removeWindowListener(this.windowListeners[e])}addWindowListener(e){window.addEventListener(e.windowEventName,e.handler),e.registered=!0}removeWindowListener(e){e&&(window.removeEventListener(e.windowEventName,e.handler),e.registered=!1)}sendRetainedArgumentsForEvent(e){const t=this.retainedEventArguments[e];t&&(delete this.retainedEventArguments[e],t.forEach(r=>{this.notifyListeners(e,r)}))}}const X=s=>encodeURIComponent(s).replace(/%(2[346B]|5E|60|7C)/g,decodeURIComponent).replace(/[()]/g,escape),Y=s=>s.replace(/(%[\dA-F]{2})+/gi,decodeURIComponent);class Me extends z{async getCookies(){const e=document.cookie,t={};return e.split(";").forEach(r=>{if(r.length<=0)return;let[n,a]=r.replace(/=/,"CAP_COOKIE").split("CAP_COOKIE");n=Y(n).trim(),a=Y(a).trim(),t[n]=a}),t}async setCookie(e){try{const t=X(e.key),r=X(e.value),n=e.expires?"; expires=".concat(e.expires.replace("expires=","")):"",a=(e.path||"/").replace("path=",""),i=e.url!=null&&e.url.length>0?"domain=".concat(e.url):"";document.cookie="".concat(t,"=").concat(r||"").concat(n,"; path=").concat(a,"; ").concat(i,";")}catch(t){return Promise.reject(t)}}async deleteCookie(e){try{document.cookie="".concat(e.key,"=; Max-Age=0")}catch(t){return Promise.reject(t)}}async clearCookies(){try{const e=document.cookie.split(";")||[];for(const t of e)document.cookie=t.replace(/^ +/,"").replace(/=.*/,"=;expires=".concat(new Date().toUTCString(),";path=/"))}catch(e){return Promise.reject(e)}}async clearAllCookies(){try{await this.clearCookies()}catch(e){return Promise.reject(e)}}}W("CapacitorCookies",{web:()=>new Me});const _e=async s=>new Promise((e,t)=>{const r=new FileReader;r.onload=()=>{const n=r.result;e(n.indexOf(",")>=0?n.split(",")[1]:n)},r.onerror=n=>t(n),r.readAsDataURL(s)}),Le=(s={})=>{const e=Object.keys(s);return Object.keys(s).map(n=>n.toLocaleLowerCase()).reduce((n,a,i)=>(n[a]=s[e[i]],n),{})},Oe=(s,e=!0)=>s?Object.entries(s).reduce((r,n)=>{const[a,i]=n;let l,u;return Array.isArray(i)?(u="",i.forEach(g=>{l=e?encodeURIComponent(g):g,u+="".concat(a,"=").concat(l,"&")}),u.slice(0,-1)):(l=e?encodeURIComponent(i):i,u="".concat(a,"=").concat(l)),"".concat(r,"&").concat(u)},"").substr(1):null,Se=(s,e={})=>{const t=Object.assign({method:s.method||"GET",headers:s.headers},e),n=Le(s.headers)["content-type"]||"";if(typeof s.data=="string")t.body=s.data;else if(n.includes("application/x-www-form-urlencoded")){const a=new URLSearchParams;for(const[i,l]of Object.entries(s.data||{}))a.set(i,l);t.body=a.toString()}else if(n.includes("multipart/form-data")||s.data instanceof FormData){const a=new FormData;if(s.data instanceof FormData)s.data.forEach((l,u)=>{a.append(u,l)});else for(const l of Object.keys(s.data))a.append(l,s.data[l]);t.body=a;const i=new Headers(t.headers);i.delete("content-type"),t.headers=i}else(n.includes("application/json")||typeof s.data=="object")&&(t.body=JSON.stringify(s.data));return t};class Ie extends z{async request(e){const t=Se(e,e.webFetchExtra),r=Oe(e.params,e.shouldEncodeUrlParams),n=r?"".concat(e.url,"?").concat(r):e.url,a=await fetch(n,t),i=a.headers.get("content-type")||"";let{responseType:l="text"}=a.ok?e:{};i.includes("application/json")&&(l="json");let u,g;switch(l){case"arraybuffer":case"blob":g=await a.blob(),u=await _e(g);break;case"json":u=await a.json();break;case"document":case"text":default:u=await a.text()}const _={};return a.headers.forEach((p,c)=>{_[c]=p}),{data:u,headers:_,status:a.status,url:a.url}}async get(e){return this.request(Object.assign(Object.assign({},e),{method:"GET"}))}async post(e){return this.request(Object.assign(Object.assign({},e),{method:"POST"}))}async put(e){return this.request(Object.assign(Object.assign({},e),{method:"PUT"}))}async patch(e){return this.request(Object.assign(Object.assign({},e),{method:"PATCH"}))}async delete(e){return this.request(Object.assign(Object.assign({},e),{method:"DELETE"}))}}W("CapacitorHttp",{web:()=>new Ie});var Z;(function(s){s.Dark="DARK",s.Light="LIGHT",s.Default="DEFAULT"})(Z||(Z={}));var Q;(function(s){s.StatusBar="StatusBar",s.NavigationBar="NavigationBar"})(Q||(Q={}));class Ce extends z{async setStyle(){this.unavailable("not available for web")}async setAnimation(){this.unavailable("not available for web")}async show(){this.unavailable("not available for web")}async hide(){this.unavailable("not available for web")}}W("SystemBars",{web:()=>new Ce});const xe=W("Motion",{android:()=>j(()=>import("./web-BJu7l8wI.js"),__vite__mapDeps([0,1,2,3])).then(s=>new s.MotionWeb),ios:()=>j(()=>import("./web-BJu7l8wI.js"),__vite__mapDeps([0,1,2,3])).then(s=>new s.MotionWeb),web:()=>j(()=>import("./web-BJu7l8wI.js"),__vite__mapDeps([0,1,2,3])).then(s=>new s.MotionWeb)});class Ae{constructor(){T(this,"remove")}async requestWebMotionPermissionIfNeeded(){const e=DeviceMotionEvent;if(typeof(e==null?void 0:e.requestPermission)=="function"&&await e.requestPermission()!=="granted")throw new Error("Motion permission not granted")}async start(e){if(U.isNativePlatform()){const r=await xe.addListener("accel",n=>{var i,l,u;const a=n.accelerationIncludingGravity;a&&e({ax:(i=a.x)!=null?i:0,ay:(l=a.y)!=null?l:0,az:(u=a.z)!=null?u:0,t:Date.now()})});this.remove=()=>r.remove();return}await this.requestWebMotionPermissionIfNeeded();const t=r=>{var a,i,l;const n=r.accelerationIncludingGravity;n&&e({ax:(a=n.x)!=null?a:0,ay:(i=n.y)!=null?i:0,az:(l=n.z)!=null?l:0,t:Date.now()})};window.addEventListener("devicemotion",t),this.remove=()=>window.removeEventListener("devicemotion",t)}async stop(){var e;(e=this.remove)==null||e.call(this),this.remove=void 0}}class De{constructor(){T(this,"timer");T(this,"running",!1)}async start(e){this.running=!0;const t=Date.now();this.timer=window.setInterval(()=>{if(!this.running)return;const r=Date.now(),n=(r-t)/1e3,a=3.2*Math.sin(n*2.5),i=.3*Math.sin(n*1.3),l=.4*Math.cos(n*1.7);e({ax:i,ay:a,az:l,t:r})},80)}async stop(){this.running=!1,this.timer&&(window.clearInterval(this.timer),this.timer=void 0)}}var ee;(function(s){s[s.Flush=0]="Flush",s[s.Add=1]="Add"})(ee||(ee={}));const te=W("TextToSpeech",{web:()=>j(()=>import("./web-DhEbpNFh.js"),__vite__mapDeps([4,1,2,3])).then(s=>new s.TextToSpeechWeb)});class Re{async speak(e){try{await te.speak({text:e,lang:"th-TH",rate:1})}catch(t){console.log("TTS not available in this environment:",t)}}async stop(){try{await te.stop()}catch(e){console.log("TTS stop not available:",e)}}}var se;(function(s){s.Heavy="HEAVY",s.Medium="MEDIUM",s.Light="LIGHT"})(se||(se={}));var D;(function(s){s.Success="SUCCESS",s.Warning="WARNING",s.Error="ERROR"})(D||(D={}));const V=W("Haptics",{web:()=>j(()=>import("./web-CXbxi2Mx.js"),__vite__mapDeps([5,1,2,3])).then(s=>new s.HapticsWeb)});class Ue{webFallback(e){"vibrate"in navigator&&navigator.vibrate(e)}async success(){if(U.isNativePlatform()){await V.notification({type:D.Success});return}try{await V.notification({type:D.Success})}catch(e){console.log("Haptics success not available (web), fallback:",e),this.webFallback(20)}}async warning(){if(U.isNativePlatform()){await V.notification({type:D.Warning});return}try{await V.notification({type:D.Warning})}catch(e){console.log("Haptics warning not available (web), fallback:",e),this.webFallback([30,40,30])}}}class We{constructor(){T(this,"listeners",new Set);T(this,"peak",-999);T(this,"valley",999);T(this,"phase","WAIT_UP");T(this,"repStartTime",0);T(this,"sumRepMsOk",0);T(this,"state",{status:"IDLE",repDisplay:0,stats:{repsTotal:0,repsOk:0,repsBad:0,score:0,avgRepMs:0,lastMessage:"พร้อมเริ่ม"}})}onChange(e){return this.listeners.add(e),e(this.clone()),()=>this.listeners.delete(e)}emit(){const e=this.clone();this.listeners.forEach(t=>t(e))}clone(){return JSON.parse(JSON.stringify(this.state))}start(){this.state={status:"RUNNING",repDisplay:0,stats:{repsTotal:0,repsOk:0,repsBad:0,score:0,avgRepMs:0,lastMessage:"เริ่มได้เลย"}},this.phase="WAIT_UP",this.peak=-999,this.valley=999,this.repStartTime=0,this.sumRepMsOk=0,this.emit()}stop(){this.state.status="STOPPED",this.state.stats.lastMessage="หยุดการทำงาน",this.emit()}reset(){this.state.status="IDLE",this.state.repDisplay=0,this.state.stats={repsTotal:0,repsOk:0,repsBad:0,score:0,avgRepMs:0,lastMessage:"รีเซ็ตแล้ว"},this.phase="WAIT_UP",this.peak=-999,this.valley=999,this.repStartTime=0,this.sumRepMsOk=0,this.emit()}process(e){if(this.state.status!=="RUNNING")return;const t=e.ay,r=Math.abs(e.ax)+Math.abs(e.az),n=2,a=-1.5,i=3,l=700,u=3500,g=5;if(this.peak=Math.max(this.peak,t),this.valley=Math.min(this.valley,t),this.phase==="WAIT_UP"){t>n&&(this.phase="WAIT_DOWN",this.repStartTime=e.t);return}if(t<a){const _=this.repStartTime>0?e.t-this.repStartTime:0,p=this.peak-this.valley;this.state.stats.repsTotal++;let c=!0,b="OK";p<i?(c=!1,b="ยกแขนต่ำเกินไป"):_<l?(c=!1,b="เร็วเกินไป"):_>u?(c=!1,b="ช้าเกินไป"):r>g&&(c=!1,b="กรุณายกแนวตั้ง"),c?(this.state.repDisplay++,this.state.stats.repsOk++,this.state.stats.score++,this.sumRepMsOk+=_,this.state.stats.avgRepMs=Math.round(this.sumRepMsOk/this.state.stats.repsOk)):this.state.stats.repsBad++,this.state.stats.lastMessage=b,this.phase="WAIT_UP",this.peak=-999,this.valley=999,this.repStartTime=0,this.emit()}}getPercentOk(){const e=this.state.stats.repsTotal;return e===0?0:Math.round(this.state.stats.repsOk/e*100)}}const $e={class:"card"},He={class:"counter card"},je={class:"num"},Be={class:"card"},Fe={class:"card"},Ne=ie({__name:"Tab1Page",setup(s){const e=J(null),t=J(!0),r=new We,n=new Ae,a=new De,i=new Re,l=new Ue;let u,g=0;function _(d){return String(d)}oe(()=>{u=r.onChange(async d=>{d.repDisplay>g?(g=d.repDisplay,await i.speak(_(d.repDisplay)),await l.success()):d.stats.lastMessage&&d.stats.lastMessage!=="OK"&&d.status==="RUNNING"&&(await i.speak(d.stats.lastMessage),await l.warning()),e.value=d})}),le(async()=>{u==null||u(),await n.stop(),await a.stop(),await i.stop()});const p=ce(()=>{if(!e.value)return 0;const d=e.value.stats.repsTotal;return d===0?0:Math.round(e.value.stats.repsOk/d*100)});async function c(){await i.speak("เริ่มกายบริหารแขน ยกขึ้นจนสุดแล้วลดลง"),g=0,r.start(),t.value?await a.start(d=>{console.log("mock sample",d),r.process(d)}):await n.start(d=>{console.log("real sample",d),r.process(d)})}async function b(){await n.stop(),await a.stop(),r.stop(),await i.speak("หยุดการทำงาน")}function L(){r.reset(),g=0}return(d,o)=>(ye(),de(y(ue),null,{default:E(()=>[M(y(fe),null,{default:E(()=>[M(y(pe),null,{default:E(()=>[M(y(he),null,{default:E(()=>[...o[1]||(o[1]=[A("Lab09 Arm Workout Sensors",-1)])]),_:1})]),_:1})]),_:1}),M(y(me),{class:"ion-padding"},{default:E(()=>{var B,F,C,$,H,N,x,h,v,m,k,P,w,S,I,K;return[f("div",$e,[o[2]||(o[2]=f("h2",null,"รหัสนักศึกษา: 673380245-4",-1)),o[3]||(o[3]=f("p",null,"ชื่อ: นางสาวศุภาฐิณี ซอสูงเนิน",-1)),f("p",null,"สถานะ: "+O((B=e.value)==null?void 0:B.status),1)]),f("div",He,[o[4]||(o[4]=f("div",{class:"label"},"รอบที่นับได้ (ถูก)",-1)),f("div",je,O((C=(F=e.value)==null?void 0:F.repDisplay)!=null?C:0),1)]),f("div",Be,[o[5]||(o[5]=f("h3",null,"สถิติ",-1)),f("p",null,"รอบทั้งหมด: "+O((H=($=e.value)==null?void 0:$.stats.repsTotal)!=null?H:0),1),f("p",null,"รอบถูก: "+O((x=(N=e.value)==null?void 0:N.stats.repsOk)!=null?x:0),1),f("p",null,"รอบผิด: "+O((v=(h=e.value)==null?void 0:h.stats.repsBad)!=null?v:0),1),f("p",null,"คะแนน: "+O((k=(m=e.value)==null?void 0:m.stats.score)!=null?k:0),1),f("p",null,"Tempo เฉลี่ย (ms): "+O((w=(P=e.value)==null?void 0:P.stats.avgRepMs)!=null?w:0),1),f("p",null,"Percent ถูก: "+O(p.value)+"%",1)]),f("div",Fe,[o[6]||(o[6]=f("h3",null,"ข้อความล่าสุด",-1)),f("p",null,O((I=(S=e.value)==null?void 0:S.stats.lastMessage)!=null?I:"-"),1)]),M(y(G),{expand:"block",onClick:c,disabled:((K=e.value)==null?void 0:K.status)==="RUNNING"},{default:E(()=>[...o[7]||(o[7]=[A(" Start ",-1)])]),_:1},8,["disabled"]),M(y(G),{expand:"block",color:"medium",onClick:b},{default:E(()=>[...o[8]||(o[8]=[A(" Stop ",-1)])]),_:1}),M(y(G),{expand:"block",color:"warning",onClick:L},{default:E(()=>[...o[9]||(o[9]=[A(" Reset ",-1)])]),_:1}),M(y(ve),{lines:"none",class:"ion-margin-top"},{default:E(()=>[M(y(ge),null,{default:E(()=>[...o[10]||(o[10]=[A("โหมดทดสอบบนคอม (Mock Sensor)",-1)])]),_:1}),M(y(we),{modelValue:t.value,"onUpdate:modelValue":o[0]||(o[0]=ae=>t.value=ae)},null,8,["modelValue"])]),_:1})]}),_:1}),M(y(be),{class:"ion-padding footer-text"},{default:E(()=>[...o[11]||(o[11]=[A(" Lab09 - Ionic + Sensors ",-1)])]),_:1})]),_:1}))}}),Ve=ke(Ne,[["__scopeId","data-v-8457f1bc"]]),Ke=Object.freeze(Object.defineProperty({__proto__:null,default:Ve},Symbol.toStringTag,{value:"Module"}));export{se as I,D as N,Ke as T,z as W};
