const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./web-Cr_3gGMa.js","./index-D_4VS2rB.js","./index-CV2ytict.css","./_plugin-vue_export-helper-DlAUqK2U.js","./web-BkgoQaO4.js","./web-Dds3jHJT.js"])))=>i.map(i=>d[i]);
var le=Object.defineProperty;var ce=(s,e,t)=>e in s?le(s,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):s[e]=t;var M=(s,e,t)=>ce(s,typeof e!="symbol"?e+"":e,t);import{_ as V,d as de,r as G,o as ue,a as pe,c as he,b as fe,w as L,u as k,I as me,e as _,f as ve,g as ge,h as H,i as we,j as f,t as S,k as ye,l as be,m as q,n as ke,p as Pe,q as Te,s as Ee,v as Me,x as Q}from"./index-D_4VS2rB.js";import{_ as Le}from"./_plugin-vue_export-helper-DlAUqK2U.js";/*! Capacitor: https://capacitorjs.com/ - MIT License */var $;(function(s){s.Unimplemented="UNIMPLEMENTED",s.Unavailable="UNAVAILABLE"})($||($={}));class z extends Error{constructor(e,t,r){super(e),this.message=e,this.code=t,this.data=r}}const _e=s=>{var e,t;return s!=null&&s.androidBridge?"android":!((t=(e=s==null?void 0:s.webkit)===null||e===void 0?void 0:e.messageHandlers)===null||t===void 0)&&t.bridge?"ios":"web"},Se=s=>{const e=s.CapacitorCustomPlatform||null,t=s.Capacitor||{},r=t.Plugins=t.Plugins||{},a=()=>e!==null?e.name:_e(s),n=()=>a()!=="web",l=c=>{const d=v.get(c);return!!(d!=null&&d.platforms.has(a())||i(c))},i=c=>{var d;return(d=t.PluginHeaders)===null||d===void 0?void 0:d.find(b=>b.name===c)},p=c=>s.console.error(c),v=new Map,w=(c,d={})=>{const b=v.get(c);if(b)return console.warn('Capacitor plugin "'.concat(c,'" already registered. Cannot register plugins twice.')),b.proxy;const O=a(),C=i(c);let P;const u=async()=>(!P&&O in d?P=typeof d[O]=="function"?P=await d[O]():P=d[O]:e!==null&&!P&&"web"in d&&(P=typeof d.web=="function"?P=await d.web():P=d.web),P),o=(h,m)=>{var y,T;if(C){const E=C==null?void 0:C.methods.find(g=>m===g.name);if(E)return E.rtype==="promise"?g=>t.nativePromise(c,m.toString(),g):(g,D)=>t.nativeCallback(c,m.toString(),g,D);if(h)return(y=h[m])===null||y===void 0?void 0:y.bind(h)}else{if(h)return(T=h[m])===null||T===void 0?void 0:T.bind(h);throw new z('"'.concat(c,'" plugin is not implemented on ').concat(O),$.Unimplemented)}},A=h=>{let m;const y=(...T)=>{const E=u().then(g=>{const D=o(g,h);if(D){const R=D(...T);return m=R==null?void 0:R.remove,R}else throw new z('"'.concat(c,".").concat(h,'()" is not implemented on ').concat(O),$.Unimplemented)});return h==="addListener"&&(E.remove=async()=>m()),E};return y.toString=()=>"".concat(h.toString(),"() { [capacitor code] }"),Object.defineProperty(y,"name",{value:h,writable:!1,configurable:!1}),y},x=A("addListener"),I=A("removeListener"),F=(h,m)=>{const y=x({eventName:h},m),T=async()=>{const g=await y;I({eventName:h,callbackId:g},m)},E=new Promise(g=>y.then(()=>g({remove:T})));return E.remove=async()=>{console.warn("Using addListener() without 'await' is deprecated."),await T()},E},U=new Proxy({},{get(h,m){switch(m){case"$$typeof":return;case"toJSON":return()=>({});case"addListener":return C?F:x;case"removeListener":return I;default:return A(m)}}});return r[c]=U,v.set(c,{name:c,proxy:U,platforms:new Set([...Object.keys(d),...C?[O]:[]])}),U};return t.convertFileSrc||(t.convertFileSrc=c=>c),t.getPlatform=a,t.handleError=p,t.isNativePlatform=n,t.isPluginAvailable=l,t.registerPlugin=w,t.Exception=z,t.DEBUG=!!t.DEBUG,t.isLoggingEnabled=!!t.isLoggingEnabled,t},Oe=s=>s.Capacitor=Se(s),B=Oe(typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{}),j=B.registerPlugin;class K{constructor(){this.listeners={},this.retainedEventArguments={},this.windowListeners={}}addListener(e,t){let r=!1;this.listeners[e]||(this.listeners[e]=[],r=!0),this.listeners[e].push(t);const n=this.windowListeners[e];n&&!n.registered&&this.addWindowListener(n),r&&this.sendRetainedArgumentsForEvent(e);const l=async()=>this.removeListener(e,t);return Promise.resolve({remove:l})}async removeAllListeners(){this.listeners={};for(const e in this.windowListeners)this.removeWindowListener(this.windowListeners[e]);this.windowListeners={}}notifyListeners(e,t,r){const a=this.listeners[e];if(!a){if(r){let n=this.retainedEventArguments[e];n||(n=[]),n.push(t),this.retainedEventArguments[e]=n}return}a.forEach(n=>n(t))}hasListeners(e){var t;return!!(!((t=this.listeners[e])===null||t===void 0)&&t.length)}registerWindowListener(e,t){this.windowListeners[t]={registered:!1,windowEventName:e,pluginEventName:t,handler:r=>{this.notifyListeners(t,r)}}}unimplemented(e="not implemented"){return new B.Exception(e,$.Unimplemented)}unavailable(e="not available"){return new B.Exception(e,$.Unavailable)}async removeListener(e,t){const r=this.listeners[e];if(!r)return;const a=r.indexOf(t);this.listeners[e].splice(a,1),this.listeners[e].length||this.removeWindowListener(this.windowListeners[e])}addWindowListener(e){window.addEventListener(e.windowEventName,e.handler),e.registered=!0}removeWindowListener(e){e&&(window.removeEventListener(e.windowEventName,e.handler),e.registered=!1)}sendRetainedArgumentsForEvent(e){const t=this.retainedEventArguments[e];t&&(delete this.retainedEventArguments[e],t.forEach(r=>{this.notifyListeners(e,r)}))}}const ee=s=>encodeURIComponent(s).replace(/%(2[346B]|5E|60|7C)/g,decodeURIComponent).replace(/[()]/g,escape),te=s=>s.replace(/(%[\dA-F]{2})+/gi,decodeURIComponent);class Ie extends K{async getCookies(){const e=document.cookie,t={};return e.split(";").forEach(r=>{if(r.length<=0)return;let[a,n]=r.replace(/=/,"CAP_COOKIE").split("CAP_COOKIE");a=te(a).trim(),n=te(n).trim(),t[a]=n}),t}async setCookie(e){try{const t=ee(e.key),r=ee(e.value),a=e.expires?"; expires=".concat(e.expires.replace("expires=","")):"",n=(e.path||"/").replace("path=",""),l=e.url!=null&&e.url.length>0?"domain=".concat(e.url):"";document.cookie="".concat(t,"=").concat(r||"").concat(a,"; path=").concat(n,"; ").concat(l,";")}catch(t){return Promise.reject(t)}}async deleteCookie(e){try{document.cookie="".concat(e.key,"=; Max-Age=0")}catch(t){return Promise.reject(t)}}async clearCookies(){try{const e=document.cookie.split(";")||[];for(const t of e)document.cookie=t.replace(/^ +/,"").replace(/=.*/,"=;expires=".concat(new Date().toUTCString(),";path=/"))}catch(e){return Promise.reject(e)}}async clearAllCookies(){try{await this.clearCookies()}catch(e){return Promise.reject(e)}}}j("CapacitorCookies",{web:()=>new Ie});const Ce=async s=>new Promise((e,t)=>{const r=new FileReader;r.onload=()=>{const a=r.result;e(a.indexOf(",")>=0?a.split(",")[1]:a)},r.onerror=a=>t(a),r.readAsDataURL(s)}),xe=(s={})=>{const e=Object.keys(s);return Object.keys(s).map(a=>a.toLocaleLowerCase()).reduce((a,n,l)=>(a[n]=s[e[l]],a),{})},Ae=(s,e=!0)=>s?Object.entries(s).reduce((r,a)=>{const[n,l]=a;let i,p;return Array.isArray(l)?(p="",l.forEach(v=>{i=e?encodeURIComponent(v):v,p+="".concat(n,"=").concat(i,"&")}),p.slice(0,-1)):(i=e?encodeURIComponent(l):l,p="".concat(n,"=").concat(i)),"".concat(r,"&").concat(p)},"").substr(1):null,De=(s,e={})=>{const t=Object.assign({method:s.method||"GET",headers:s.headers},e),a=xe(s.headers)["content-type"]||"";if(typeof s.data=="string")t.body=s.data;else if(a.includes("application/x-www-form-urlencoded")){const n=new URLSearchParams;for(const[l,i]of Object.entries(s.data||{}))n.set(l,i);t.body=n.toString()}else if(a.includes("multipart/form-data")||s.data instanceof FormData){const n=new FormData;if(s.data instanceof FormData)s.data.forEach((i,p)=>{n.append(p,i)});else for(const i of Object.keys(s.data))n.append(i,s.data[i]);t.body=n;const l=new Headers(t.headers);l.delete("content-type"),t.headers=l}else(a.includes("application/json")||typeof s.data=="object")&&(t.body=JSON.stringify(s.data));return t};class Re extends K{async request(e){const t=De(e,e.webFetchExtra),r=Ae(e.params,e.shouldEncodeUrlParams),a=r?"".concat(e.url,"?").concat(r):e.url,n=await fetch(a,t),l=n.headers.get("content-type")||"";let{responseType:i="text"}=n.ok?e:{};l.includes("application/json")&&(i="json");let p,v;switch(i){case"arraybuffer":case"blob":v=await n.blob(),p=await Ce(v);break;case"json":p=await n.json();break;case"document":case"text":default:p=await n.text()}const w={};return n.headers.forEach((c,d)=>{w[d]=c}),{data:p,headers:w,status:n.status,url:n.url}}async get(e){return this.request(Object.assign(Object.assign({},e),{method:"GET"}))}async post(e){return this.request(Object.assign(Object.assign({},e),{method:"POST"}))}async put(e){return this.request(Object.assign(Object.assign({},e),{method:"PUT"}))}async patch(e){return this.request(Object.assign(Object.assign({},e),{method:"PATCH"}))}async delete(e){return this.request(Object.assign(Object.assign({},e),{method:"DELETE"}))}}j("CapacitorHttp",{web:()=>new Re});var se;(function(s){s.Dark="DARK",s.Light="LIGHT",s.Default="DEFAULT"})(se||(se={}));var ae;(function(s){s.StatusBar="StatusBar",s.NavigationBar="NavigationBar"})(ae||(ae={}));class Ue extends K{async setStyle(){this.unavailable("not available for web")}async setAnimation(){this.unavailable("not available for web")}async show(){this.unavailable("not available for web")}async hide(){this.unavailable("not available for web")}}j("SystemBars",{web:()=>new Ue});const He=j("Motion",{android:()=>V(()=>import("./web-Cr_3gGMa.js"),__vite__mapDeps([0,1,2,3]),import.meta.url).then(s=>new s.MotionWeb),ios:()=>V(()=>import("./web-Cr_3gGMa.js"),__vite__mapDeps([0,1,2,3]),import.meta.url).then(s=>new s.MotionWeb),web:()=>V(()=>import("./web-Cr_3gGMa.js"),__vite__mapDeps([0,1,2,3]),import.meta.url).then(s=>new s.MotionWeb)});class We{constructor(){M(this,"remove")}async requestWebMotionPermissionIfNeeded(){const e=DeviceMotionEvent;if(typeof(e==null?void 0:e.requestPermission)=="function"&&await e.requestPermission()!=="granted")throw new Error("Motion permission not granted")}async start(e){if(B.isNativePlatform()){const r=await He.addListener("accel",a=>{var l,i,p;const n=a.accelerationIncludingGravity;n&&e({ax:(l=n.x)!=null?l:0,ay:(i=n.y)!=null?i:0,az:(p=n.z)!=null?p:0,t:Date.now()})});this.remove=()=>r.remove();return}await this.requestWebMotionPermissionIfNeeded();const t=r=>{var n,l,i;const a=r.accelerationIncludingGravity;a&&e({ax:(n=a.x)!=null?n:0,ay:(l=a.y)!=null?l:0,az:(i=a.z)!=null?i:0,t:Date.now()})};window.addEventListener("devicemotion",t),this.remove=()=>window.removeEventListener("devicemotion",t)}async stop(){var e;(e=this.remove)==null||e.call(this),this.remove=void 0}}class $e{constructor(){M(this,"timer");M(this,"running",!1)}async start(e){this.running=!0;const t=Date.now();this.timer=window.setInterval(()=>{if(!this.running)return;const r=Date.now(),a=(r-t)/1e3,n=3.2*Math.sin(a*2.5),l=.3*Math.sin(a*1.3),i=.4*Math.cos(a*1.7);e({ax:l,ay:n,az:i,t:r})},80)}async stop(){this.running=!1,this.timer&&(window.clearInterval(this.timer),this.timer=void 0)}}var ne;(function(s){s[s.Flush=0]="Flush",s[s.Add=1]="Add"})(ne||(ne={}));const re=j("TextToSpeech",{web:()=>V(()=>import("./web-BkgoQaO4.js"),__vite__mapDeps([4,1,2,3]),import.meta.url).then(s=>new s.TextToSpeechWeb)});class Be{async speak(e){try{await re.speak({text:e,lang:"th-TH",rate:1})}catch(t){console.log("TTS not available in this environment:",t)}}async stop(){try{await re.stop()}catch(e){console.log("TTS stop not available:",e)}}}var ie;(function(s){s.Heavy="HEAVY",s.Medium="MEDIUM",s.Light="LIGHT"})(ie||(ie={}));var W;(function(s){s.Success="SUCCESS",s.Warning="WARNING",s.Error="ERROR"})(W||(W={}));const N=j("Haptics",{web:()=>V(()=>import("./web-Dds3jHJT.js"),__vite__mapDeps([5,1,2,3]),import.meta.url).then(s=>new s.HapticsWeb)});class je{webFallback(e){"vibrate"in navigator&&navigator.vibrate(e)}async success(){if(B.isNativePlatform()){await N.notification({type:W.Success});return}try{await N.notification({type:W.Success})}catch(e){console.log("Haptics success not available (web), fallback:",e),this.webFallback(20)}}async warning(){if(B.isNativePlatform()){await N.notification({type:W.Warning});return}try{await N.notification({type:W.Warning})}catch(e){console.log("Haptics warning not available (web), fallback:",e),this.webFallback([30,40,30])}}}class Ve{constructor(){M(this,"listeners",new Set);M(this,"peak",-999);M(this,"valley",999);M(this,"phase","WAIT_UP");M(this,"repStartTime",0);M(this,"sumRepMsOk",0);M(this,"state",{status:"IDLE",repDisplay:0,stats:{repsTotal:0,repsOk:0,repsBad:0,score:0,avgRepMs:0,lastMessage:"พร้อมเริ่ม"}})}onChange(e){return this.listeners.add(e),e(this.clone()),()=>this.listeners.delete(e)}emit(){const e=this.clone();this.listeners.forEach(t=>t(e))}clone(){return JSON.parse(JSON.stringify(this.state))}start(){this.state={status:"RUNNING",repDisplay:0,stats:{repsTotal:0,repsOk:0,repsBad:0,score:0,avgRepMs:0,lastMessage:"เริ่มได้เลย"}},this.phase="WAIT_UP",this.peak=-999,this.valley=999,this.repStartTime=0,this.sumRepMsOk=0,this.emit()}stop(){this.state.status="STOPPED",this.state.stats.lastMessage="หยุดการทำงาน",this.emit()}reset(){this.state.status="IDLE",this.state.repDisplay=0,this.state.stats={repsTotal:0,repsOk:0,repsBad:0,score:0,avgRepMs:0,lastMessage:"รีเซ็ตแล้ว"},this.phase="WAIT_UP",this.peak=-999,this.valley=999,this.repStartTime=0,this.sumRepMsOk=0,this.emit()}process(e){if(this.state.status!=="RUNNING")return;const t=e.ay,r=Math.abs(e.ax)+Math.abs(e.az),a=2,n=-1.5,l=3,i=700,p=3500,v=5;if(this.peak=Math.max(this.peak,t),this.valley=Math.min(this.valley,t),this.phase==="WAIT_UP"){t>a&&(this.phase="WAIT_DOWN",this.repStartTime=e.t);return}if(t<n){const w=this.repStartTime>0?e.t-this.repStartTime:0,c=this.peak-this.valley;this.state.stats.repsTotal++;let d=!0,b="OK";c<l?(d=!1,b="ยกแขนต่ำเกินไป"):w<i?(d=!1,b="เร็วเกินไป"):w>p?(d=!1,b="ช้าเกินไป"):r>v&&(d=!1,b="กรุณายกแนวตั้ง"),d?(this.state.repDisplay++,this.state.stats.repsOk++,this.state.stats.score++,this.sumRepMsOk+=w,this.state.stats.avgRepMs=Math.round(this.sumRepMsOk/this.state.stats.repsOk)):this.state.stats.repsBad++,this.state.stats.lastMessage=b,this.phase="WAIT_UP",this.peak=-999,this.valley=999,this.repStartTime=0,this.emit()}}getPercentOk(){const e=this.state.stats.repsTotal;return e===0?0:Math.round(this.state.stats.repsOk/e*100)}}const Fe={class:"card"},Ne={class:"counter card"},Ge={class:"num"},qe={class:"card"},ze={class:"card"},Ke={key:0,class:"error"},Je=de({__name:"HomeView",setup(s){const e=G(null),t=G(""),r=G(!("DeviceMotionEvent"in window)),a=new Ve,n=new We,l=new $e,i=new Be,p=new je;let v,w=0,c="";function d(u){return String(u)}ue(()=>{v=a.onChange(async u=>{var x;if(e.value=u,u.repDisplay>w){w=u.repDisplay,c="";try{await i.speak(d(u.repDisplay)),await p.success()}catch(I){console.log("TTS/Haptics error:",I)}return}const o=(x=u.stats.lastMessage)!=null?x:"";if(o&&o!=="OK"&&u.status==="RUNNING"&&o!==c){c=o;try{await i.speak(o),await p.warning()}catch(I){console.log("TTS/Haptics error:",I)}}})}),pe(async()=>{v==null||v(),await n.stop(),await l.stop(),await i.stop()});const b=he(()=>{if(!e.value)return 0;const u=e.value.stats.repsTotal;return u===0?0:Math.round(e.value.stats.repsOk/u*100)});async function O(){t.value="",w=0,c="";try{await i.speak("เริ่มกายบริหารแขน ยกขึ้นจนสุดแล้วลดลง")}catch(u){console.log("TTS start error:",u)}a.start();try{r.value?await l.start(u=>{console.log("mock sample",u),a.process(u)}):await n.start(u=>{console.log("real sample",u),a.process(u)})}catch(u){console.log("Start motion error:",u),t.value="เริ่มใช้งาน Sensor ไม่สำเร็จ (ถ้าใช้ iPhone แนะนำเปิดผ่าน HTTPS และอนุญาต Motion/Orientation)"}}async function C(){t.value="",await n.stop(),await l.stop(),a.stop();try{await i.speak("หยุดการทำงาน")}catch(u){console.log("TTS stop error:",u)}}function P(){t.value="",w=0,c="",a.start()}return(u,o)=>(Q(),fe(k(me),null,{default:L(()=>[_(k(we),null,{default:L(()=>[_(k(ve),null,{default:L(()=>[_(k(ge),null,{default:L(()=>[...o[1]||(o[1]=[H("Lab09 Arm Workout Sensors",-1)])]),_:1})]),_:1})]),_:1}),_(k(Ee),{class:"ion-padding"},{default:L(()=>{var A,x,I,F,U,h,m,y,T,E,g,D,R,J,X,Y,Z;return[f("div",Fe,[o[2]||(o[2]=f("h2",null,"รหัสนักศึกษา: 673380245-4",-1)),o[3]||(o[3]=f("p",null,"ชื่อ: นางสาวศุภาฐิณี ซอสูงเนิน",-1)),f("p",null,"สถานะ: "+S((x=(A=e.value)==null?void 0:A.status)!=null?x:"IDLE"),1)]),f("div",Ne,[o[4]||(o[4]=f("div",{class:"label"},"รอบที่นับได้ (ถูก)",-1)),f("div",Ge,S((F=(I=e.value)==null?void 0:I.repDisplay)!=null?F:0),1)]),f("div",qe,[o[5]||(o[5]=f("h3",null,"สถิติ",-1)),f("p",null,"รอบทั้งหมด: "+S((h=(U=e.value)==null?void 0:U.stats.repsTotal)!=null?h:0),1),f("p",null,"รอบถูก: "+S((y=(m=e.value)==null?void 0:m.stats.repsOk)!=null?y:0),1),f("p",null,"รอบผิด: "+S((E=(T=e.value)==null?void 0:T.stats.repsBad)!=null?E:0),1),f("p",null,"คะแนน: "+S((D=(g=e.value)==null?void 0:g.stats.score)!=null?D:0),1),f("p",null,"Tempo เฉลี่ย (ms): "+S((J=(R=e.value)==null?void 0:R.stats.avgRepMs)!=null?J:0),1),f("p",null,"Percent ถูก: "+S(b.value)+"%",1)]),f("div",ze,[o[6]||(o[6]=f("h3",null,"ข้อความล่าสุด",-1)),f("p",null,S((Y=(X=e.value)==null?void 0:X.stats.lastMessage)!=null?Y:"-"),1),t.value?(Q(),ye("p",Ke,S(t.value),1)):be("",!0)]),_(k(q),{expand:"block",onClick:O,disabled:((Z=e.value)==null?void 0:Z.status)==="RUNNING"},{default:L(()=>[...o[7]||(o[7]=[H(" Start ",-1)])]),_:1},8,["disabled"]),_(k(q),{expand:"block",color:"medium",onClick:C},{default:L(()=>[...o[8]||(o[8]=[H(" Stop ",-1)])]),_:1}),_(k(q),{expand:"block",color:"warning",onClick:P},{default:L(()=>[...o[9]||(o[9]=[H(" Reset ",-1)])]),_:1}),_(k(ke),{lines:"none",class:"ion-margin-top"},{default:L(()=>[_(k(Pe),null,{default:L(()=>[...o[10]||(o[10]=[H("โหมดทดสอบบนคอม (Mock Sensor)",-1)])]),_:1}),_(k(Te),{modelValue:r.value,"onUpdate:modelValue":o[0]||(o[0]=oe=>r.value=oe)},null,8,["modelValue"])]),_:1}),o[11]||(o[11]=f("p",{class:"hint"}," * ถ้าเปิดบน iPhone แล้วต้องการใช้ sensor จริง แนะนำเปิดผ่าน HTTPS (เช่น GitHub Pages) และปิด Mock ",-1))]}),_:1}),_(k(Me),{class:"ion-padding footer-text"},{default:L(()=>[...o[12]||(o[12]=[H(" Lab09 - Ionic + Sensors ",-1)])]),_:1})]),_:1}))}}),Xe=Le(Je,[["__scopeId","data-v-5ee33d22"]]),et=Object.freeze(Object.defineProperty({__proto__:null,default:Xe},Symbol.toStringTag,{value:"Module"}));export{et as H,ie as I,W as N,K as W};
